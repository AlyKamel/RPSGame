(this.webpackJsonprpsgame=this.webpackJsonprpsgame||[]).push([[0],{13:function(t,e,n){},14:function(t,e,n){},16:function(t,e,n){"use strict";n.r(e);var a=n(1),c=n.n(a),o=n(7),r=n.n(o),s=(n(13),n(2)),i=n(3),u=n(5),h=n(4),l=(n(14),n(8)),j="https://rps-game-server.herokuapp.com/";function p(t,e){return fetch(t,{method:"POST",body:e})}function d(t,e,n){var a=new URLSearchParams({move:n});return p("".concat(j,"matches/").concat(t,"/players/").concat(e,"/play"),a)}function b(t,e,n){var a="".concat(j,"matches/").concat(t,"/players/").concat(e,"/play_upload");return fetch(a,{method:"POST",body:n})}var m=n(0);function O(t){return Object(m.jsxs)("label",{children:[t.name,":",Object(m.jsx)("input",{name:t.name,type:"number",min:"0",onChange:t.changeHandler})]})}function v(t){return Object(m.jsxs)("label",{children:[t.name,":",Object(m.jsx)("input",{name:t.name,type:"text",maxLength:"10",onChange:t.changeHandler})]})}function f(t){return Object(m.jsxs)("div",{children:[Object(m.jsx)("input",{type:"radio",id:"bot",name:"opponentType",value:"bot",defaultChecked:!0,onChange:t.changeHandler}),Object(m.jsx)("label",{htmlFor:"bot",children:"Bot"}),Object(m.jsx)("input",{type:"radio",id:"human",name:"opponentType",value:"human",onChange:t.changeHandler}),Object(m.jsx)("label",{htmlFor:"human",children:"Human"})]})}function x(t){return Object(m.jsxs)("div",{children:[Object(m.jsx)("label",{htmlFor:"gamecount",children:"Game count:"}),Object(m.jsx)("input",{type:"radio",id:"1gamecount",name:"gamecount",value:1,onChange:t.changeHandler}),Object(m.jsx)("label",{htmlFor:"1gamecount",children:"1"}),Object(m.jsx)("input",{type:"radio",id:"3gamecount",name:"gamecount",value:3,defaultChecked:!0,onChange:t.changeHandler}),Object(m.jsx)("label",{htmlFor:"3gamecount",children:"3"}),Object(m.jsx)("input",{type:"radio",id:"10gamecount",name:"gamecount",value:10,onChange:t.changeHandler}),Object(m.jsx)("label",{htmlFor:"10gamecount",children:"10"}),Object(m.jsx)("br",{})]})}function g(t){return Object(m.jsxs)("div",{children:[Object(m.jsx)("input",{type:"radio",id:"joinMatch",name:"enterMatch",value:"joinMatch",onChange:t.onEntryChange}),Object(m.jsx)("label",{htmlFor:"joinMatch",children:"join match"}),Object(m.jsx)("input",{type:"radio",id:"createMatch",name:"enterMatch",value:"createMatch",onChange:t.onEntryChange}),Object(m.jsx)("label",{htmlFor:"createMatch",children:"create match"}),Object(m.jsx)("br",{})]})}var C=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).selectMatchEntry=function(t){var e="joinMatch"===t.target.value;a.setState({matchEntryChosen:!0,joinMatch:e})},a.handleChange=function(t){var e=t.target.name;a.setState(Object(l.a)({},e,t.target.value))},a.submit=function(t){t.preventDefault(),function(t,e){var n=new URLSearchParams({name:t});p(j+"start",n).then((function(t){return t.json()})).then((function(t){console.log(t),e(t)})).catch((function(t){return alert("unable to create player: "+t),-1}))}(a.state.username,(function(t){var e,n,c;a.state.joinMatch?(n=a.state.matchID,c=t.id,e=p("".concat(j,"matches/").concat(n,"/players/").concat(c))):e=function(t,e,n){var a=new URLSearchParams({gamecount:n,playerId:t});return e&&a.append("botMatch",!0),p(j+"matches",a)}(t.id,"bot"===a.state.opponentType,a.state.gamecount),e.then((function(t){return t.ok?t.json():t.json().then((function(t){throw t.message}))})).then((function(e){a.props.startMatch(e,t)})).catch((function(t){alert("unable to ".concat(a.state.joinMatch?"join":"create"," match: ").concat(t))}))}))},a.state={loggedIn:!1,matchEntryChosen:!1,joinMatch:!1,gamecount:3,opponentType:"bot"},a}return Object(i.a)(n,[{key:"render",value:function(){var t="";return this.state.matchEntryChosen&&(t=this.state.joinMatch?Object(m.jsx)(O,{name:"matchID",changeHandler:this.handleChange}):Object(m.jsxs)("div",{children:[Object(m.jsx)(f,{changeHandler:this.handleChange}),Object(m.jsx)(x,{changeHandler:this.handleChange})]})),Object(m.jsxs)("div",{children:[Object(m.jsx)("h1",{children:"RPS Game"}),Object(m.jsxs)("form",{onSubmit:this.submit,children:[Object(m.jsx)(v,{name:"username",changeHandler:this.handleChange}),Object(m.jsx)("br",{}),t,Object(m.jsx)("br",{}),Object(m.jsx)(g,{choiceMade:this.state.matchEntryChosen,joinMatch:!1,onEntryChange:this.selectMatchEntry}),Object(m.jsx)("input",{type:"submit",disabled:!this.state.matchEntryChosen})]})]})}}]),n}(c.a.Component);function y(t){var e=["rock","paper","scissors"][t.move],n="RPSGame/resources/hand-"+e+".png";return Object(m.jsx)("input",{type:"image",src:n,alt:e,value:t.move,onClick:t.handleClick})}function M(t){return Object(m.jsxs)("p",{children:["MatchID ",Object(m.jsx)("span",{children:t.matchID}),": Win: ",Object(m.jsx)("span",{children:t.winCount})," | Loss: ",Object(m.jsx)("span",{children:t.lossCount})," | Tie: ",Object(m.jsx)("span",{children:t.tieCount})]})}var w=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(s.a)(this,n);for(var a=arguments.length,c=new Array(a),o=0;o<a;o++)c[o]=arguments[o];return(t=e.call.apply(e,[this].concat(c))).selectMove=function(e){var n=e.target.value,a=d(t.props.matchID,t.props.userID,n);t.handleResult(a)},t.uploadMove=function(e){var n=b(t.props.matchID,t.props.userID,e);t.handleResult(n)},t.handleResult=function(e){e.then((function(t){return t.ok?t.json():t.json().then((function(t){throw t.message}))})).then((function(e){t.props.showResult(e.match,e.duelresult,e.endresult)})).catch((function(t){alert("unable to send move: ".concat(t))}))},t}return Object(i.a)(n,[{key:"render",value:function(){for(var t=[],e=0;e<=2;++e)t.push(Object(m.jsx)(y,{move:e,handleClick:this.selectMove},e));return Object(m.jsxs)("div",{class:"container-fluid",children:[Object(m.jsx)("p",{children:"Select a move:"}),t,Object(m.jsx)("br",{}),Object(m.jsx)("p",{children:"Or upload a move:"}),Object(m.jsx)(k,{uploadMove:this.uploadMove}),Object(m.jsx)("br",{})]})}}]),n}(c.a.Component),k=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(s.a)(this,n);for(var a=arguments.length,c=new Array(a),o=0;o<a;o++)c[o]=arguments[o];return(t=e.call.apply(e,[this].concat(c))).doUpload=function(){var e=document.querySelector('input[type="file"]').files[0];t.props.uploadMove(e)},t}return Object(i.a)(n,[{key:"render",value:function(){return Object(m.jsxs)("form",{id:"uploadForm",encType:"multipart/form-data",children:[Object(m.jsx)("input",{name:"file",type:"file",accept:"image/*"}),Object(m.jsx)("input",{type:"button",value:"Upload",onClick:this.doUpload})]})}}]),n}(c.a.Component),S=w,E=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){return Object(s.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var t=this;setTimeout((function(){t.props.afterResultShown()}),1200)}},{key:"render",value:function(){return Object(m.jsxs)("div",{children:[Object(m.jsx)(y,{move:this.props.user.move}),"\xa0\xa0",Object(m.jsx)(y,{move:this.props.opponent.move})]})}}]),n}(c.a.Component),I=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).toActionView=function(){0===a.state.match.duelcount?a.props.endMatch(a.state.endresult):a.setState({moveChosen:!1})},a.showResult=function(t,e,n){switch(a.setState({moveChosen:!0,match:t,user:t.players.find((function(t){return t.id===a.props.user.id})),opponent:t.players.find((function(t){return t.id!==a.props.user.id})),endresult:n}),e){case 1:a.setState((function(t){return{winCount:t.winCount+1}}));break;case-1:a.setState((function(t){return{lossCount:t.lossCount+1}}));break;case 0:a.setState((function(t){return{tieCount:t.tieCount+1}}));break;default:throw Error("invalid result")}},a.state={moveChosen:!1,match:a.props.match,winCount:0,lossCount:0,tieCount:0,user:a.props.user},a.state.opponent=t.match.players.find((function(t){return t.id!==a.props.user.id})),a}return Object(i.a)(n,[{key:"render",value:function(){var t="";t=this.state.moveChosen?Object(m.jsx)(E,{user:this.state.user,opponent:this.state.opponent,afterResultShown:this.toActionView}):Object(m.jsx)(S,{matchID:this.state.match.id,userID:this.props.user.id,showResult:this.showResult});var e=void 0===this.state.opponent?" waiting for opponent...":" vs. Opponent "+this.state.opponent.name;return Object(m.jsxs)("div",{children:[Object(m.jsxs)("p",{children:["Player ",this.state.user.name+e]}),t,Object(m.jsx)(M,{matchID:this.state.match.id,winCount:this.state.winCount,lossCount:this.state.lossCount,tieCount:this.state.tieCount})]})}}]),n}(c.a.Component),R=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){return Object(s.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var t;switch(this.props.result){case 1:t="win";break;case-1:t="lose";break;case 0:t="tie";break;default:throw new Error("invalid result")}return Object(m.jsxs)("div",{children:[Object(m.jsxs)("p",{children:["Game Over. You ",t]}),Object(m.jsx)("button",{onClick:this.props.toStartPage,children:"To start page"})]})}}]),n}(c.a.Component),D=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).toMatchAction=function(t,e){a.setState({match:t,user:e,viewMode:1})},a.toMatchEnd=function(t){a.setState({viewMode:2,endresult:t})},a.toStartPage=function(){a.setState({match:null,user:null,winCount:0,lossCount:0,tieCount:0,endresult:null,viewMode:0})},a.state={viewMode:0,match:null,user:null,winCount:0,lossCount:0,tieCount:0,endresult:null},a}return Object(i.a)(n,[{key:"render",value:function(){var t="";switch(this.state.viewMode){case 0:t=Object(m.jsx)(C,{startMatch:this.toMatchAction});break;case 1:t=Object(m.jsx)(I,{match:this.state.match,user:this.state.user,endMatch:this.toMatchEnd});break;case 2:t=Object(m.jsx)(R,{result:this.state.endresult,toStartPage:this.toStartPage});break;default:throw new Error("invalid state")}return Object(m.jsx)("div",{className:"App",children:t})}}]),n}(c.a.Component);r.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(D,{})}),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.c8396b67.chunk.js.map